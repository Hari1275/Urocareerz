# Story 1.2: User Profile Creation

## Status
Draft

## Story
**As a** registered user (mentee, mentor, or admin),
**I want** to create and manage my profile with role-specific information,
**so that** I can provide relevant details for opportunities and connections

## Acceptance Criteria
1. User can access profile creation after successful authentication
2. User can select their role (mentee, mentor, admin) during profile setup
3. User can provide basic information (first name, last name, bio, location)
4. Mentee can add education, interests, and purpose of registration
5. Mentor can add specialty, sub-specialty, workplace, and years of experience
6. User can upload and manage avatar image (JPG, PNG, WebP, max 5MB)
7. User can upload and manage resume/CV (PDF, DOC, DOCX, max 10MB)
8. Profile information is validated and sanitized
9. Profile data is encrypted and securely stored
10. User can edit and update their profile information
11. Profile changes are logged for audit purposes
12. Profile completion status is tracked for platform analytics

## Tasks / Subtasks
- [ ] Task 1: Extend database schema for profile management (AC: 1, 2, 3, 4, 5, 9, 12)
  - [ ] Create Profile model with role-specific fields
  - [ ] Establish one-to-one relationship with User model
  - [ ] Add profile completion tracking fields
  - [ ] Implement soft delete for profile data
- [ ] Task 2: Create profile API endpoints (AC: 1, 2, 3, 4, 5, 10, 11)
  - [ ] GET /api/profile - Retrieve current user's profile
  - [ ] POST /api/profile - Create new profile
  - [ ] PUT /api/profile - Update existing profile
  - [ ] Implement role-based field validation
  - [ ] Add profile completion calculation logic
- [ ] Task 3: Implement file upload functionality (AC: 6, 7, 9)
  - [ ] Create AWS S3 integration for file storage
  - [ ] Implement signed URL generation for secure access
  - [ ] Add file type and size validation
  - [ ] Create file upload API endpoints
  - [ ] Implement file deletion and replacement logic
- [ ] Task 4: Build profile UI components (AC: 1, 2, 3, 4, 5, 6, 7, 10)
  - [ ] Create profile creation wizard component
  - [ ] Build role selection interface
  - [ ] Create form components for mentee-specific fields
  - [ ] Create form components for mentor-specific fields
  - [ ] Implement file upload components with drag-and-drop
  - [ ] Create profile preview and edit components
- [ ] Task 5: Add validation and security measures (AC: 8, 9, 11)
  - [ ] Implement Zod validation schemas for profile data
  - [ ] Add input sanitization and XSS prevention
  - [ ] Implement file upload security measures
  - [ ] Add audit logging for profile changes
  - [ ] Create profile data encryption utilities
- [ ] Task 6: Implement profile completion tracking (AC: 12)
  - [ ] Create profile completion calculation algorithm
  - [ ] Add completion status to user dashboard
  - [ ] Implement profile completion analytics
  - [ ] Create profile completion notifications

## Dev Notes

### Previous Story Insights
From Story 1.1 (User Authentication Setup):
- User model already includes basic fields (firstName, lastName, email, role)
- Authentication system provides secure session management
- JWT tokens include user role information
- Audit logging system is in place for tracking user actions

### Data Models
Based on the architecture document, the Profile model should include:
- `id: ObjectId` (Primary Key)
- `userId: ObjectId` (Foreign Key to User, unique)
- Common fields: `bio: String`, `location: String`, `avatar: String`, `resume: String`
- Mentee fields: `education: String`, `interests: String[]`, `purposeOfRegistration: String`
- Mentor fields: `specialty: String`, `subSpecialty: String`, `workplace: String`, `availabilityStatus: String`, `yearsOfExperience: Int`
- Timestamps: `createdAt: DateTime`, `updatedAt: DateTime`

[Source: ARCHITECTURE_DOCUMENT.md#3.1 Schema Design]

### API Specifications
Profile management endpoints to implement:
- `GET /api/profile` - Retrieve current user's profile
- `POST /api/profile` - Create new profile (requires authentication)
- `PUT /api/profile` - Update existing profile (requires authentication)
- `POST /api/upload/avatar` - Upload avatar image
- `POST /api/upload/resume` - Upload resume/CV
- `DELETE /api/upload/{fileType}` - Delete uploaded file

File upload endpoints should return signed URLs for secure access
[Source: ARCHITECTURE_DOCUMENT.md#5.1 Route Structure]

### Component Specifications
Profile UI components needed:
- Profile creation wizard with role selection
- Role-specific form components (mentee vs mentor fields)
- File upload components with drag-and-drop support
- Profile preview and edit components
- Form validation using React Hook Form + Zod
- Progress indicators for profile completion

[Source: ARCHITECTURE_DOCUMENT.md#6.2 State Management Strategy]

### File Locations
Based on the existing project structure:
- API routes: `src/app/api/profile/`, `src/app/api/upload/`
- UI components: `src/components/profile/`
- Database models: `prisma/schema.prisma` (extend existing)
- Validation schemas: `src/lib/validations.ts` (add profile schemas)
- File upload utilities: `src/lib/upload.ts`
- Profile utilities: `src/lib/profile.ts`

[Source: ARCHITECTURE_DOCUMENT.md#6.1 Component Structure]

### Testing Requirements
- Unit tests for profile validation logic
- Integration tests for profile API endpoints
- Component tests for profile forms and file uploads
- Security tests for file upload validation
- E2E tests for profile creation workflow
- Test file location: `__tests__/` or `src/__tests__/`

[Source: ARCHITECTURE_DOCUMENT.md#10.1 Performance Optimizations]

### Technical Constraints
- Use Next.js 15.4.1 with React 19.1.0
- MongoDB with Prisma ORM (extend existing schema)
- AWS S3 for file storage with signed URLs
- File size limits: Avatar (5MB), Resume (10MB)
- Supported formats: Avatar (JPG, PNG, WebP), Resume (PDF, DOC, DOCX)
- Data encryption at rest for sensitive profile information
- Role-based field validation and access control

[Source: ARCHITECTURE_DOCUMENT.md#2.2 Technology Stack]

### Testing
**Testing Standards from Architecture:**
- Test file location: `__tests__/` directory
- Test standards: Unit tests for business logic, integration tests for API endpoints
- Testing frameworks: Jest with React Testing Library
- Specific testing requirements: Profile validation testing, file upload security testing, role-based access testing

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-05 | 1.0 | Initial story creation | Bob (SM) |

## Dev Agent Record

### Agent Model Used
TBD

### Debug Log References
TBD

### Completion Notes List
TBD

### File List
TBD

## QA Results
TBD 