# Story 1.3: Opportunity/Job Board

## Status
Draft

## Story
**As a** mentor or mentee,
**I want** to create, browse, and manage opportunities (jobs, fellowships, observerships),
**so that** I can connect with career opportunities and share relevant positions

## Acceptance Criteria
1. Mentors can create new opportunities with title, description, location, and requirements
2. Mentees can browse opportunities with basic filters (location, experience level)
3. Opportunities can be categorized as jobs, fellowships, or observerships
4. All opportunities require admin approval before being published
5. Mentees can save opportunities for later review
6. Mentees can apply to opportunities with cover letter and resume
7. Mentors can view and manage applications they receive
8. Opportunities include source attribution for external opportunities
9. Opportunities have application deadlines and status tracking
10. System supports both mentor-created and mentee-submitted opportunities
11. Opportunities are searchable and filterable
12. All opportunity actions are logged for audit purposes

## Tasks / Subtasks
- [ ] Task 1: Extend database schema for opportunities (AC: 1, 3, 4, 8, 9, 10)
  - [ ] Create Opportunity model with unified creator field
  - [ ] Create OpportunityType model for categorization
  - [ ] Create Application model for mentee applications
  - [ ] Create SavedOpportunity model for bookmarks
  - [ ] Add status tracking and admin approval fields
- [ ] Task 2: Create opportunity management API endpoints (AC: 1, 4, 7, 8, 9, 10)
  - [ ] GET /api/opportunities - List opportunities with filters
  - [ ] POST /api/opportunities - Create new opportunity
  - [ ] GET /api/opportunities/[id] - Get opportunity details
  - [ ] PUT /api/opportunities/[id] - Update opportunity
  - [ ] DELETE /api/opportunities/[id] - Delete opportunity
  - [ ] GET /api/opportunity-types - List opportunity types
- [ ] Task 3: Implement application system (AC: 6, 7, 12)
  - [ ] POST /api/applications - Submit application
  - [ ] GET /api/applications - List user's applications
  - [ ] PUT /api/applications/[id] - Update application status
  - [ ] Implement application validation and constraints
  - [ ] Add application status tracking
- [ ] Task 4: Create saved opportunities functionality (AC: 5)
  - [ ] POST /api/saved-opportunities - Save opportunity
  - [ ] GET /api/saved-opportunities - List saved opportunities
  - [ ] DELETE /api/saved-opportunities - Remove saved opportunity
  - [ ] Implement unique constraint for saved opportunities
- [ ] Task 5: Build opportunity UI components (AC: 1, 2, 3, 5, 6, 7)
  - [ ] Create opportunity creation form component
  - [ ] Build opportunity listing and card components
  - [ ] Create opportunity detail view component
  - [ ] Implement search and filter components
  - [ ] Create application form component
  - [ ] Build saved opportunities management UI
- [ ] Task 6: Implement admin approval workflow (AC: 4, 9, 12)
  - [ ] Create admin approval interface
  - [ ] Implement opportunity status management
  - [ ] Add admin feedback and notes system
  - [ ] Create approval notification system
  - [ ] Add audit logging for approval actions
- [ ] Task 7: Add search and filtering capabilities (AC: 2, 11)
  - [ ] Implement basic search functionality
  - [ ] Create filter components (location, experience level, type)
  - [ ] Add pagination for large result sets
  - [ ] Implement sorting options
  - [ ] Add search result highlighting

## Dev Notes

### Previous Story Insights
From Story 1.1 (User Authentication Setup):
- Authentication system provides secure session management
- JWT tokens include user role information
- Audit logging system is in place

From Story 1.2 (User Profile Creation):
- Profile model includes role-specific fields
- File upload system for resumes is implemented
- AWS S3 integration is available for file storage

### Data Models
Based on the architecture document, the opportunity models should include:

**Opportunity Model:**
- `id: ObjectId` (Primary Key)
- `title: String`, `description: String`
- `location: String`, `experienceLevel: String`
- `opportunityTypeId: ObjectId` (Foreign Key)
- `creatorId: ObjectId` (Foreign Key to User)
- `creatorRole: Role` (MENTOR or MENTEE)
- `sourceUrl: String`, `sourceName: String` (for external opportunities)
- `requirements: String`, `benefits: String`, `duration: String`, `compensation: String`
- `applicationDeadline: DateTime`
- `status: OpportunityStatus` (PENDING, APPROVED, REJECTED, EXPIRED)
- `adminFeedback: String`, `adminNotes: String`
- `createdAt, updatedAt, deletedAt: DateTime`

**OpportunityType Model:**
- `id: ObjectId` (Primary Key)
- `name: String` (unique), `description: String`
- `color: String`, `isActive: Boolean`
- `createdAt, updatedAt: DateTime`

**Application Model:**
- `id: ObjectId` (Primary Key)
- `menteeId: ObjectId` (Foreign Key to User)
- `opportunityId: ObjectId` (Foreign Key to Opportunity)
- `status: ApplicationStatus` (PENDING, ACCEPTED, REJECTED, WITHDRAWN)
- `coverLetter: String`, `resumeUrl: String`
- `createdAt, updatedAt: DateTime`
- Unique constraint on [menteeId, opportunityId]

**SavedOpportunity Model:**
- `id: ObjectId` (Primary Key)
- `userId: ObjectId` (Foreign Key to User)
- `opportunityId: ObjectId` (Foreign Key to Opportunity)
- `createdAt: DateTime`
- Unique constraint on [userId, opportunityId]

[Source: ARCHITECTURE_DOCUMENT.md#3.1 Schema Design]

### API Specifications
Opportunity management endpoints to implement:
- `GET /api/opportunities` - List opportunities with query parameters
- `POST /api/opportunities` - Create new opportunity (requires authentication)
- `GET /api/opportunities/[id]` - Get opportunity details
- `PUT /api/opportunities/[id]` - Update opportunity (creator only)
- `DELETE /api/opportunities/[id]` - Delete opportunity (creator only)
- `GET /api/opportunity-types` - List opportunity types
- `POST /api/applications` - Submit application
- `GET /api/applications` - List user's applications
- `PUT /api/applications/[id]` - Update application status
- `POST /api/saved-opportunities` - Save opportunity
- `GET /api/saved-opportunities` - List saved opportunities
- `DELETE /api/saved-opportunities` - Remove saved opportunity

[Source: ARCHITECTURE_DOCUMENT.md#5.1 Route Structure]

### Component Specifications
Opportunity UI components needed:
- Opportunity creation form with role-based fields
- Opportunity listing with cards and grid layout
- Opportunity detail view with full information
- Search and filter sidebar components
- Application form with cover letter and resume upload
- Saved opportunities management interface
- Admin approval dashboard for opportunities
- Application management interface for mentors

[Source: ARCHITECTURE_DOCUMENT.md#6.2 State Management Strategy]

### File Locations
Based on the existing project structure:
- API routes: `src/app/api/opportunities/`, `src/app/api/applications/`, `src/app/api/saved-opportunities/`
- UI components: `src/components/opportunities/`, `src/components/applications/`
- Database models: `prisma/schema.prisma` (extend existing)
- Validation schemas: `src/lib/validations.ts` (add opportunity schemas)
- Opportunity utilities: `src/lib/opportunities.ts`
- Application utilities: `src/lib/applications.ts`

[Source: ARCHITECTURE_DOCUMENT.md#6.1 Component Structure]

### Testing Requirements
- Unit tests for opportunity validation logic
- Integration tests for opportunity API endpoints
- Component tests for opportunity forms and listings
- E2E tests for opportunity creation and application workflow
- Security tests for role-based access control
- Performance tests for search and filtering
- Test file location: `__tests__/` or `src/__tests__/`

[Source: ARCHITECTURE_DOCUMENT.md#10.1 Performance Optimizations]

### Technical Constraints
- Use Next.js 15.4.1 with React 19.1.0
- MongoDB with Prisma ORM (extend existing schema)
- Role-based access control for opportunity management
- Admin approval workflow for all opportunities
- Search and filtering with pagination
- File upload integration for application resumes
- Audit logging for all opportunity actions
- Soft delete for data integrity

[Source: ARCHITECTURE_DOCUMENT.md#2.2 Technology Stack]

### Testing
**Testing Standards from Architecture:**
- Test file location: `__tests__/` directory
- Test standards: Unit tests for business logic, integration tests for API endpoints
- Testing frameworks: Jest with React Testing Library
- Specific testing requirements: Opportunity validation testing, role-based access testing, search functionality testing

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-05 | 1.0 | Initial story creation | Bob (SM) |

## Dev Agent Record

### Agent Model Used
TBD

### Debug Log References
TBD

### Completion Notes List
TBD

### File List
TBD

## QA Results
TBD 